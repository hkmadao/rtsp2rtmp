(this.webpackJsonprtsp2rtmpweb=this.webpackJsonprtsp2rtmpweb||[]).push([[0],{152:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(12),c=a.n(r),i=a(83),l=a(16),d=a(109),s=a(14),u=a(195),j=a(153),b=a(216),h=a(220),p=a(219),f=a(215),O=a(217),m=a(224),x=a(218),v=a(108),g=a.n(v),w=a(107),k=a.n(w),C=a(212),y=a(211),R=a(213),S=a(214),L=a(106),E=a.n(L),N=a(101),I=a.n(N),B=a(203),T=a(226),U=a(202),P=a(200),F=a(199),M=a(201),A=a(3),D=Object(u.a)((function(e){return{root:{width:"100%"}}}));function V(e){var t=D(),a=o.a.useState(!1),r=Object(s.a)(a,2),c=r[0],i=r[1],l=o.a.useState(e.dialog.title),d=Object(s.a)(l,2),u=d[0],j=(d[1],o.a.useState(e.dialog.content)),b=Object(s.a)(j,2),h=b[0];b[1];Object(n.useImperativeHandle)(e.onRef,(function(){return{handleClickOpen:p}}));var p=function(){i(!0)},f=function(){i(!1)};return Object(A.jsx)("div",{className:t.root,children:Object(A.jsxs)(T.a,{open:c,onClose:f,"aria-labelledby":"form-dialog-title",children:[Object(A.jsx)(F.a,{id:"form-dialog-title",children:u}),Object(A.jsx)(P.a,{children:Object(A.jsx)(M.a,{children:h})}),Object(A.jsx)(U.a,{children:Object(A.jsx)(B.a,{onClick:f,color:"primary",children:"OK"})})]})})}var H=a(77),W=a(205),z=a(206),q=a(51),J=a(58),Y=a.n(J),_=a(204),K=a(227),$=a(43),G={serverURL:window.location.origin},Q=a(33),X=a.n(Q);X.a.defaults.withCredentials=!1,X.a.defaults.timeout=1e4,X.a.interceptors.request.use((function(e){var t=window.localStorage.getItem("token");return e.headers.token=t,e}),(function(e){return console.error(e),Promise.reject(e)})),X.a.interceptors.response.use((function(e){return e.data&&e.data.errcode&&401===parseInt(e.data.errcode)&&(window.location.hash="#/login"),e}),(function(e){return X.a.isCancel()||(e.response?(console.log(401===e.response.status),401===e.response.status?window.localStorage.getItem("token")&&window.localStorage.getItem("tokenExpired")&&"false"!==window.localStorage.getItem("tokenExpired")||(window.localStorage.setItem("tokenExpired","true"),window.location.hash="#/login"):500===e.response.status&&alert("server exception !")):e&&"error: timeout"===String(e).toLowerCase().substring(0,14)?alert("server timeout !"):alert("server error !")),Promise.reject(e)}));var Z=G.serverURL,ee=function(e,t){return X.a.post("".concat(Z).concat(e),t).then((function(e){return e.data}))},te="".concat(G.serverURL),ae=function(e){return function(e,t){return X.a.get("".concat(Z).concat(e),{params:t}).then((function(e){return e.data}))}("/camera/list",e)},ne=function(e){return ee("/camera/edit",e)},oe=function(e){return ee("/camera/delete",e)},re=function(e){return ee("/camera/enabled",e)},ce=Object(u.a)((function(e){return{appBar:{position:"relative",backgroundColor:"#eebbaa"},title:{marginLeft:e.spacing(2),flex:1},videoContainer:{width:"90%",margin:"0 auto"}}})),ie=o.a.forwardRef((function(e,t){return Object(A.jsx)(_.a,Object(H.a)({direction:"up",ref:t},e))}));function le(e){var t=ce(),a=o.a.useState(!1),r=Object(s.a)(a,2),c=r[0],i=r[1],l=o.a.useState(!0),d=Object(s.a)(l,2),u=d[0],j=d[1],b=null,h=0;Object(n.useImperativeHandle)(e.onRef,(function(){return{handleClickOpen:p}}));var p=function(){i(!0)},f=function(){i(!1)},O=function(t){var a={type:"flv"},n=te+"/live/permanent/"+e.row.code+"/"+e.row.authCode+".flv";a.url=n,a.hasAudio=u,a.isLive=!0,console.log("MediaDataSource",a),m(a)},m=function(e){var t=document.getElementsByClassName("centeredVideo")[0];"undefined"!==typeof b&&null!=b&&(b.pause(),b.unload(),b.detachMediaElement(),b.destroy(),b=null),(b=$.a.createPlayer(e,{enableWorker:!1,lazyLoadMaxDuration:180,seekType:"range"})).on($.a.Events.ERROR,(function(e,t,a){console.log("errorType:",e),console.log("errorDetail:",t),console.log("errorInfo:",a),b&&(b.pause(),b.unload(),b.detachMediaElement(),b.destroy(),b=null,window.setTimeout(O,500))})),b.on($.a.Events.STATISTICS_INFO,(function(e){0!=h?h!=e.decodedFrames?h=e.decodedFrames:(console.log("decodedFrames:",e.decodedFrames),h=0,b&&(b.pause(),b.unload(),b.detachMediaElement(),b.destroy(),b=null,window.setTimeout(O,500))):h=e.decodedFrames})),b.attachMediaElement(t),b.load(),b.play()};return Object(A.jsx)("div",{children:Object(A.jsxs)(T.a,{fullScreen:!0,open:c,onClose:f,TransitionComponent:ie,children:[Object(A.jsx)(W.a,{className:t.appBar,children:Object(A.jsxs)(z.a,{children:[Object(A.jsx)(B.a,{variant:"contained",onClick:O,children:"play"}),Object(A.jsxs)(q.a,{variant:"h6",className:t.title,children:["hasAudio",Object(A.jsx)(K.a,{checked:u,id:"Audio",color:"primary",name:"hasAudio",onChange:function(e){j(e.target.checked)},inputProps:{"aria-label":"primary checkbox"}})]}),Object(A.jsx)(B.a,{autoFocus:!0,color:"inherit",onClick:f,children:Object(A.jsx)(Y.a,{})})]})}),Object(A.jsx)("div",{className:t.videoContainer,children:Object(A.jsx)("div",{children:Object(A.jsx)("video",{name:"videoElement",className:"centeredVideo",controls:!0,allow:"autoPlay",width:"100%",children:"Your browser is too old which doesn't support HTML5 video."})})})]})})}var de=a(225),se=a(222),ue=a(208),je=Object(u.a)((function(e){return{appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},formClass:{"& > *":{margin:e.spacing(1),width:"25ch"}},formDiv:{margin:"0 auto"}}})),be=o.a.forwardRef((function(e,t){return Object(A.jsx)(_.a,Object(H.a)({direction:"up",ref:t},e))}));function he(e){var t=je(),a=o.a.useState(!1),r=Object(s.a)(a,2),c=r[0],i=r[1],l=o.a.useState(1===e.row.enabled),d=Object(s.a)(l,2),u=d[0],j=d[1],b=o.a.useState({id:e.row.id,code:e.row.code,rtspURL:e.row.rtspURL,rtmpURL:e.row.rtmpURL,authCode:e.row.authCode,onlineStatus:e.row.onlineStatus,enabled:e.row.enabled}),h=Object(s.a)(b,2),p=h[0],f=(h[1],o.a.useState(!1)),O=Object(s.a)(f,2),m=O[0],x=O[1],v=o.a.useState(""),g=Object(s.a)(v,2),w=g[0],k=g[1];Object(n.useImperativeHandle)(e.onRef,(function(){return{handleClickOpen:C}}));var C=function(){i(!0)},y=function(){i(!1)},R=function(t){ne(p).then((function(t){if(1===t.code)return i(!1),void(e.callBack&&e.callBack());k(t.msg),x(!0),window.setTimeout((function(){x(!1)}),5e3)}))},S=function(e){console.log(e.target.value),p[e.target.id]=e.target.value};return Object(A.jsx)("div",{children:Object(A.jsxs)(T.a,{fullScreen:!0,open:c,onClose:y,TransitionComponent:be,children:[Object(A.jsx)(W.a,{className:t.appBar,children:Object(A.jsxs)(z.a,{children:[Object(A.jsx)(B.a,{variant:"contained",onClick:R,children:"save"}),Object(A.jsx)("span",{children:"\xa0\xa0"}),"edit"===e.type?Object(A.jsx)(B.a,{variant:"contained",onClick:function(t){oe(p).then((function(t){if(1===t.code)return i(!1),void(e.callBack&&e.callBack());k(t.msg),x(!0),window.setTimeout((function(){x(!1)}),5e3)}))},children:"delete"}):"",Object(A.jsx)(q.a,{variant:"h6",className:t.title}),Object(A.jsx)(B.a,{autoFocus:!0,color:"inherit",onClick:y,children:Object(A.jsx)(Y.a,{})})]})}),m?Object(A.jsxs)(se.a,{severity:"error",children:[Object(A.jsx)(ue.a,{children:"Error"}),w," ",Object(A.jsx)("strong",{children:"check it out!"})]}):"",Object(A.jsx)("div",{className:t.formDiv,children:Object(A.jsxs)("form",{className:t.formClass,noValidate:!0,autoComplete:"off",onSubmit:R,children:["edit"===e.type?Object(A.jsx)("div",{children:Object(A.jsx)(de.a,{id:"id",label:"id",InputProps:{readOnly:!0},defaultValue:p.id})}):"",Object(A.jsx)("div",{children:Object(A.jsx)(de.a,{id:"code",label:"code",defaultValue:p.code,onChange:S})}),Object(A.jsx)("div",{children:Object(A.jsx)(de.a,{id:"rtspURL",label:"rtspURL",defaultValue:p.rtspURL,onChange:S})}),Object(A.jsx)("div",{children:Object(A.jsx)(de.a,{id:"rtmpURL",label:"rtmpURL",defaultValue:p.rtmpURL,onChange:S})}),"edit"===e.type?"":Object(A.jsx)("div",{children:Object(A.jsx)(K.a,{checked:u,id:"enabled",onChange:function(e){console.log(e.target.checked),p[e.target.id]=e.target.checked?1:0,"enabled"===e.target.id&&j(e.target.checked)},color:"primary",name:"enabled",inputProps:{"aria-label":"primary checkbox"}})})]})})]})})}var pe=Object(u.a)((function(){return{root:{position:"relative"},dropdown:{position:"absolute",top:28,right:0,left:0,zIndex:999,border:"0px solid",padding:1,backgroundColor:"#f8f8f8"}}}));function fe(e){var t=pe(),a=o.a.useState(!1),n=Object(s.a)(a,2),r=n[0],c=n[1],i=o.a.useState({title:"Success",content:"copy success !"}),l=Object(s.a)(i,2),d=l[0],u=(l[1],o.a.useState(e.row)),j=Object(s.a)(u,2),b=j[0],h=(j[1],o.a.createRef());var p=o.a.createRef();var f=o.a.createRef();return Object(A.jsx)(C.a,{onClickAway:function(){c(!1)},children:Object(A.jsxs)("div",{className:t.root,children:[Object(A.jsx)("button",{type:"button",onClick:function(){c((function(e){return!e}))},children:Object(A.jsx)(E.a,{})}),r?Object(A.jsx)("div",{className:t.dropdown,children:Object(A.jsxs)(y.a,{component:"nav","aria-label":"secondary mailbox folders",children:[Object(A.jsx)(R.a,{button:!0,children:Object(A.jsx)(S.a,{primary:"edit",onClick:function(){c(!1),p.current.handleClickOpen()}})}),Object(A.jsx)(R.a,{button:!0,onClick:function(){b.enabled=1===b.enabled?0:1,re(b).then((function(t){if(1===t.code)return c(!1),void(e.callBack&&e.callBack())}))},children:1===e.row.enabled?Object(A.jsx)(S.a,{primary:"turn-off"}):Object(A.jsx)(S.a,{primary:"turn-on"})}),Object(A.jsx)(R.a,{button:!0,onClick:function(){c(!1),h.current.handleClickOpen()},children:Object(A.jsx)(S.a,{primary:"play"})}),Object(A.jsx)(R.a,{button:!0,onClick:function(){c(!1);var t=window.location.origin+window.location.pathname+"#/live?method=permanent&code="+e.row.code+"&authCode="+e.row.authCode;I()(t),f.current.handleClickOpen()},children:Object(A.jsx)(S.a,{primary:"share"})})]})}):null,Object(A.jsx)(le,{row:e.row,onRef:h}),Object(A.jsx)(he,{row:e.row,type:"edit",callBack:e.callBack,onRef:p}),Object(A.jsx)(V,{dialog:d,onRef:f})]})})}var Oe=[{id:"id",label:"id",minWidth:170},{id:"code",label:"code",minWidth:100},{id:"rtspURL",label:"rtspURL"},{id:"rtmpURL",label:"rtmpURL"},{id:"authCode",label:"authCode"},{id:"onlineStatus",label:"onlineStatus",format:function(e){return e&&1===e?Object(A.jsx)(k.a,{}):Object(A.jsx)(g.a,{})}},{id:"enabled",label:"enabled",format:function(e){return Object(A.jsx)(K.a,{checked:1===e,id:"enabled",color:"primary",name:"enabled",inputProps:{"aria-label":"primary checkbox"}})}},{id:"action",label:"action",format:function(e,t,a){return Object(A.jsx)(fe,{row:t,callBack:a})}}],me=Object(u.a)((function(e){return{root:{width:"100%",position:"relative"},container:{minHeight:400},dropdown:{position:"absolute",top:28,right:0,left:0,zIndex:0,border:"0px solid",padding:1,backgroundColor:"#f8f8f8"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}}}));function xe(){var e,t,a=me(),n=o.a.useState(0),r=Object(s.a)(n,2),c=r[0],i=r[1],l=o.a.useState(10),u=Object(s.a)(l,2),v=u[0],g=u[1],w=o.a.useState([]),k=Object(s.a)(w,2);e=k[0],t=k[1];var C=function(){ae().then((function(a){var n;e.splice(0),(n=e).push.apply(n,Object(d.a)(a.data.page)),t([]),t(e)}))},y=o.a.createRef();return o.a.useEffect(C,[]),Object(A.jsxs)(j.a,{className:a.root,children:[Object(A.jsx)(W.a,{className:a.appBar,children:Object(A.jsxs)(z.a,{children:[Object(A.jsx)(B.a,{variant:"contained",onClick:function(){y.current.handleClickOpen()},children:"ADD"}),Object(A.jsx)(q.a,{variant:"h6",className:a.title})]})}),Object(A.jsx)(he,{row:{id:"",code:"",rtspURL:"",rtmpURL:"",authCode:"",onlineStatus:0,enabled:1},type:"add",callBack:C,onRef:y}),Object(A.jsx)(f.a,{className:a.container,children:Object(A.jsxs)(b.a,{stickyHeader:!0,"aria-label":"sticky table",children:[Object(A.jsx)(O.a,{children:Object(A.jsx)(x.a,{children:Oe.map((function(e){return Object(A.jsx)(p.a,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id)}))})}),Object(A.jsx)(h.a,{children:e.slice(c*v,c*v+v).map((function(e){return Object(A.jsx)(x.a,{hover:!0,role:"checkbox",tabIndex:-1,children:Oe.map((function(t){var a=e[t.id];return Object(A.jsx)(p.a,{align:t.align,children:t.format?t.format(a,e,C):a},t.id)}))},e.code)}))})]})}),Object(A.jsx)(m.a,{rowsPerPageOptions:[10,25,100],component:"div",count:e.length,rowsPerPage:v,page:c,onChangePage:function(e,t){i(t)},onChangeRowsPerPage:function(e){g(+e.target.value),i(0)}})]})}var ve=a(7),ge=a(8),we=a(20),ke=a(19),Ce=function(e){Object(we.a)(a,e);var t=Object(ke.a)(a);function a(){return Object(ve.a)(this,a),t.apply(this,arguments)}return Object(ge.a)(a,[{key:"render",value:function(){return Object(A.jsx)("h2",{children:"404"})}}]),a}(o.a.Component),ye=Object(u.a)((function(e){return{appBar:{position:"relative",backgroundColor:"#eebbaa"},title:{marginLeft:e.spacing(2),flex:1},videoContainer:{width:"90%",margin:"0 auto"}}}));function Re(e){var t=ye(),a=o.a.useState(!0),n=Object(s.a)(a,2),r=n[0],c=n[1],i=null,l=0,d=function(e){var t=new RegExp("(^|&|\\?)"+e+"=([^&]*)(&|$)","i"),a=window.location.hash.substr(1).match(t);return null!=a?decodeURIComponent(a[2]):null},u=function(e){var t=d("method"),a=d("code"),n=d("authCode");if(t&&a&&n){var o={type:"flv"},c=te+"/live/"+t+"/"+a+"/"+n+".flv";o.url=c,o.hasAudio=r,o.isLive=!0,console.log("MediaDataSource",o),j(o)}},j=function(e){var t=document.getElementsByClassName("centeredVideo")[0];"undefined"!==typeof i&&null!=i&&(i.pause(),i.unload(),i.detachMediaElement(),i.destroy(),i=null),(i=$.a.createPlayer(e,{enableWorker:!1,lazyLoadMaxDuration:180,seekType:"range"})).on($.a.Events.ERROR,(function(e,t,a){console.log("errorType:",e),console.log("errorDetail:",t),console.log("errorInfo:",a),i&&(i.pause(),i.unload(),i.detachMediaElement(),i.destroy(),i=null,window.setTimeout(u,500))})),i.on($.a.Events.STATISTICS_INFO,(function(e){0!=l?l!=e.decodedFrames?l=e.decodedFrames:(console.log("decodedFrames:",e.decodedFrames),l=0,i&&(i.pause(),i.unload(),i.detachMediaElement(),i.destroy(),i=null,window.setTimeout(u,500))):l=e.decodedFrames})),i.attachMediaElement(t),i.load(),i.play()};return Object(A.jsx)("div",{children:Object(A.jsxs)("div",{children:[Object(A.jsx)(W.a,{className:t.appBar,children:Object(A.jsxs)(z.a,{children:[Object(A.jsx)(B.a,{variant:"contained",onClick:u,children:"play"}),Object(A.jsxs)(q.a,{variant:"h6",className:t.title,children:["hasAudio",Object(A.jsx)(K.a,{checked:r,id:"Audio",color:"primary",name:"hasAudio",onChange:function(e){c(e.target.checked)},inputProps:{"aria-label":"primary checkbox"}})]})]})}),Object(A.jsx)("div",{className:t.videoContainer,children:Object(A.jsx)("div",{children:Object(A.jsx)("video",{name:"videoElement",className:"centeredVideo",controls:!0,allow:"autoPlay",width:"100%",children:"Your browser is too old which doesn't support HTML5 video."})})})]})})}function Se(e){return Object(A.jsxs)(l.c,{children:[Object(A.jsx)(l.a,{exact:!0,path:"/",component:xe}),Object(A.jsx)(l.a,{exact:!0,path:"/live",component:Re}),Object(A.jsx)(l.a,{component:Ce})]})}var Le=Object(n.memo)(Se);var Ee=function(){return Object(A.jsx)("div",{children:Object(A.jsx)(i.a,{children:Object(A.jsx)(Le,{})})})};function Ne(){return Object(A.jsx)(Ee,{})}c.a.render(Object(A.jsx)(Ne,{}),document.querySelector("#app"))}},[[152,1,2]]]);
//# sourceMappingURL=main.8767d5c1.chunk.js.map